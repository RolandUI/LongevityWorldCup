<!DOCTYPE html>
<html lang="en">
<head>
    <!--HEAD-->
    <link rel="stylesheet" href="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.css">
    <style>
        /* Hide the join-game button in the header */
        .join-game {
            display: none;
        }

        .autocomplete-items {
            position: absolute;
            background: white; /* white panel */
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* soft drop shadow */
            border: none; /* no harsh border */
            max-height: 150px; /* scroll if too tall */
            overflow-y: auto;
            z-index: 9999;
            left: 0;
            right: 0; /* ensures it spans exactly the container */
            box-sizing: border-box; /* include any padding/borders in that width */
            top: calc(100% - 2px); /* slide up by the input’s 2px bottom border so it’s flush */
            border-radius: 0 0 30px 30px; /* match your input’s 30px pill corners */
            width: 100%;
        }

            .autocomplete-items div {
                padding: 0.75rem 1rem; /* generous touch targets */
                font-size: 0.95rem;
            }

                .autocomplete-items div:not(:last-child) {
                    border-bottom: 1px solid #eee; /* light separator between items */
                }

                .autocomplete-items div:hover,
                .autocomplete-active {
                    background-color: #0069d9; /* your blue hover */
                    color: #fff;
                }

        #niceInputFieldDisplayWrapper {
            position: relative;
            width: 80%;
            max-width: 400px;
            margin: 0.1rem auto;
        }

        #divisionDisplayInput, #flagDisplayInput, #mediaContactInput, #personalLinkInput {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #ccc;
            border-radius: 30px;
            font-size: 1rem;
            transition: border-color 0.2s;
            background-color: #f9f9f9;
        }

            #divisionDisplayInput:focus, #flagDisplayInput:focus, #mediaContactInput:focus, #personalLinkInput:focus {
                outline: none;
                border-color: #4CAF50;
                box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.3);
            }

        #divisionDisplaySelect {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #ccc;
            border-radius: 30px;
            font-size: 1rem;
            transition: border-color 0.2s;
            background-color: #f9f9f9;
            appearance: none;
        }

            #divisionDisplaySelect:focus {
                outline: none;
                border-color: #4CAF50;
                box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.3);
            }

        /* center the cropper modal and its buttons */
        #changeProfileCropperModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            z-index: 10000;
            padding: 1.5rem;
            width: 80vw;
            max-width: 360px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

            #changeProfileCropperModal button {
                margin-top: 0.5rem;
                width: auto;
            }

            /* make the modal’s inner options fill its container */
            #changeProfileCropperModal .options-container {
                width: 100%;
                max-width: none; /* override any global cap */
                display: flex;
                flex-direction: column;
                gap: 0.75rem; /* adjust spacing between buttons if you like */
            }

            #changeProfileCropperModal .option-button {
                width: 100%;
                max-width: none; /* ensure they stretch edge-to-edge */
            }

        #changeProfileCropperImage {
            max-width: 100%;
            max-height: 300px;
            object-fit: contain;
        }

        /* dark backdrop & lock scroll when modal is open */
        #modalOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            z-index: 9998; /* sits just under the modal’s 10000 */
        }

        .no-scroll {
            overflow: hidden;
        }

        .options-container.inline-option-group {
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 80%;
            max-width: 400px;
            margin: 0 auto;
        }

        /* shrink any icon-only button down to its icon */
        .option-button.icon-only {
            width: 60px;
            height: 60px;
            max-width: none;
            padding: 0;
            margin: 0;
        }

        #editOptionsGroup {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            gap: 0.5rem;
            margin: 0 auto;
        }

        #changeProfilePicButton {
            width: 100%;
            flex: 1 1 0;
        }

        .icon-only {
            flex: 0 0 60px;
            width: 60px;
            height: 60px;
        }
    </style>
</head>
<body>
    <!--HEADER-->
    <main>
        <h2 id="character-title" data-aos="fade" data-aos-duration="700" data-aos-delay="250">Character Selection</h2>
        <div style="text-align: center;" data-aos="fade" data-aos-duration="700" data-aos-delay="300">
            <picture>
                <source srcset="../assets/content-images/headshot.webp" type="image/webp">
                <source srcset="../assets/content-images/headshot.jpg" type="image/jpeg">
                <img src="../assets/content-images/headshot.jpg" alt="Headshot" class="illustration" loading="lazy">
            </picture>
        </div>
        <div id="editOptionsGroup" cdata-aos="fade" data-aos-duration="700" data-aos-delay="350">
            <div id="changeProfilePicWrapper" class="options-container inline-option-group">
                <button id="changeProfilePicButton" class="option-button grey">
                    Change Profile Picture
                </button>
                <input type="file" id="profilePicInputModal" accept="image/*" style="display: none;">
                <button id="restoreProfilePicButton" class="option-button icon-only" style="display:none" title="Restore Profile Picture">
                    <i class="fa fa-undo"></i>
                </button>
            </div>
            <div id="niceInputFieldDisplayWrapper" class="options-container inline-option-group">
                <select id="divisionDisplaySelect"></select>
                <button id="restoreDivisionBtn" class="option-button icon-only" style="display:none" title="Restore Division">
                    <i class="fa fa-undo"></i>
                </button>
            </div>
            <div id="niceInputFieldDisplayWrapper" class="options-container inline-option-group">
                <input type="text"
                       id="flagDisplayInput"
                       name="flagDisplay"
                       autocomplete="off"
                       placeholder="Type or select a flag…">
                <button id="restoreFlagBtn" class="option-button icon-only" style="display:none" title="Restore Flag">
                    <i class="fa fa-undo"></i>
                </button>
            </div>
            <div id="niceInputFieldDisplayWrapper" class="options-container inline-option-group">
                <input type="text"
                       id="personalLinkInput"
                       name="personalLink"
                       autocomplete="off"
                       placeholder="Enter personal link…">
                <button id="restorePersonalLinkBtn" class="option-button icon-only" style="display:none" title="Restore Personal Link">
                    <i class="fa fa-undo"></i>
                </button>
            </div>
            <div id="niceInputFieldDisplayWrapper" class="options-container inline-option-group">
                <input type="text"
                       id="mediaContactInput"
                       name="mediaContact"
                       autocomplete="off"
                       placeholder="Enter media contact…">
                <button id="restoreMediaContactBtn" class="option-button icon-only" style="display:none" title="Restore Media Contact">
                    <i class="fa fa-undo"></i>
                </button>
            </div>
        </div>
        <div class="options-container" data-aos="fade" data-aos-duration="700" data-aos-delay="400">
            <button id="submitButton" type="submit" disabled class="option-button green"></button>
            <button class="option-button back-button" onclick="window.goBackOrHome()">
                <i class="fas fa-arrow-left"></i>&nbsp;Back
            </button>
        </div>

        <div id="changeProfileCropperModal" style="display:none">
            <img id="changeProfileCropperImage" src="" alt="Cropper Preview">
            <div class="options-container">
                <button id="changeProfileCropButton" class="option-button green">Crop & Save</button>
                <button id="changeProfileCancelButton" class="option-button grey">Cancel</button>
            </div>
        </div>
        <div id="modalOverlay"></div>
    </main>
    <!--FOOTER-->
    <script>
        const athlete = JSON.parse(sessionStorage.getItem('selectedAthlete'));

        if (!sessionStorage.getItem('initialProfilePicSrc')) sessionStorage.setItem('initialProfilePicSrc', athlete.ProfilePic);
        const originalProfilePicSrc = sessionStorage.getItem('initialProfilePicSrc');

        if (!sessionStorage.getItem('initialDivision')) sessionStorage.setItem('initialDivision', athlete.Division);
        const originalDivision = sessionStorage.getItem('initialDivision');

        if (!sessionStorage.getItem('initialFlag')) sessionStorage.setItem('initialFlag', athlete.Flag);
        const originalFlag = sessionStorage.getItem('initialFlag');

        if (!sessionStorage.getItem('initialPersonalLink')) sessionStorage.setItem('initialPersonalLink', athlete.PersonalLink || '');
        const _storedPL = sessionStorage.getItem('initialPersonalLink');
        const originalPersonalLink = (_storedPL === 'null' ? '' : _storedPL);

        if (!sessionStorage.getItem('initialMediaContact')) sessionStorage.setItem('initialMediaContact', athlete.MediaContact);
        const originalMediaContact = sessionStorage.getItem('initialMediaContact');

        setSubmitChangeRequestButton();

        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(() => {
                const viewTarget = document.querySelector('h2');
                viewTarget.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 500);

            document.getElementById('character-title').textContent = athlete.Name;
            document.querySelector('picture').innerHTML = `
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <img src="${athlete.ProfilePic}"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        alt="${athlete.Name} headshot"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        class="illustration"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        loading="lazy">`;
            if (athlete.ProfilePic !== originalProfilePicSrc) {
                document.getElementById('restoreProfilePicButton').style.display = 'inline-flex';
                updateSubmitButtonState();
            }

            // — DIVISION PREFILL & CHANGE/RESTORE LOGIC —
            const divisionSelect = document.getElementById('divisionDisplaySelect');
            const restoreDivisionBtn = document.getElementById('restoreDivisionBtn');

            // Populate the dropdown
            fetch('/api/data/divisions')
                .then(r => r.json())
                .then(divs => {
                    divisionSelect.innerHTML = '';
                    divs.forEach(d => {
                        const opt = document.createElement('option');
                        opt.value = d;
                        opt.textContent = `${window.TryGetDivisionIcon(d)} ${d}`;
                        divisionSelect.appendChild(opt);
                    });
                    divisionSelect.value = athlete.Division;

                    if (athlete.Division !== originalDivision) {
                        restoreDivisionBtn.style.display = 'inline-flex';
                        updateSubmitButtonState();
                    }
                });

            // When the user picks a different division…
            divisionSelect.addEventListener('change', () => {
                athlete.Division = divisionSelect.value;
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                if (divisionSelect.value === originalDivision) {
                    // back to the original → hide restore & disable submit
                    restoreDivisionBtn.style.display = 'none';
                } else {
                    // actually different → show restore & enable submit
                    restoreDivisionBtn.style.display = 'inline-flex';
                }
                updateSubmitButtonState();
            });

            // Restore original division
            restoreDivisionBtn.addEventListener('click', () => {
                divisionSelect.value = originalDivision;
                athlete.Division = originalDivision;
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                restoreDivisionBtn.style.display = 'none';
                updateSubmitButtonState();
            });

            // —— FLAG INPUT & AUTOCOMPLETE LOGIC ——
            const flagInput = document.getElementById('flagDisplayInput');
            const restoreFlagBtn = document.getElementById('restoreFlagBtn');
            const originalFlag = sessionStorage.getItem('initialFlag');

            // Fetch and prepare flag list
            let availableFlags = [];
            fetch('/api/data/flags')
                .then(r => r.json())
                .then(flags => {
                    if (!flags.includes(athlete.Flag)) flags.push(athlete.Flag);
                    availableFlags = flags.sort((a, b) => a.localeCompare(b));
                    flagInput.value = athlete.Flag;
                    if (athlete.Flag !== originalFlag) {
                        restoreFlagBtn.style.display = 'inline-flex';
                        updateSubmitButtonState();
                    }
                });

            // Autocomplete dropdown
            flagInput.addEventListener('input', function () {
                // Show or hide the Restore-Flag button based on whether the input matches original
                if (flagInput.value.trim() !== originalFlag) {
                    restoreFlagBtn.style.display = 'inline-flex';
                } else {
                    restoreFlagBtn.style.display = 'none';
                }

                // Show or hide the Restore-Flag button based on whether the input matches original
                if (flagInput.value.trim() !== originalFlag) {
                    restoreFlagBtn.style.display = 'inline-flex';
                } else {
                    restoreFlagBtn.style.display = 'none';
                }
                updateSubmitButtonState();

                // Hide autocomplete if input exactly matches one of the flags
                if (availableFlags.includes(flagInput.value.trim())) {
                    closeFlagLists();
                    return;
                }

                const terms = this.value.trim().toLowerCase().split(/\s+/).filter(t => t);
                closeFlagLists();
                if (!terms.length) return;
                const list = document.createElement('div');
                list.id = this.id + '-autocomplete-list';
                list.className = 'autocomplete-items';
                this.parentNode.appendChild(list);
                let count = 0;
                availableFlags.forEach(f => {
                    if (count >= 5) return;
                    const lower = f.toLowerCase();
                    if (terms.every(t => lower.includes(t))) {
                        const item = document.createElement('div');
                        item.className = 'flag-autocomplete-item';
                        item.textContent = f;
                        item.dataset.value = f;
                        item.addEventListener('mousedown', e => {
                            e.preventDefault();
                            selectFlag(e.target.dataset.value);
                        });
                        list.appendChild(item);
                        count++;
                    }
                });
            });

            flagInput.addEventListener('keydown', function (e) {
                let items = document.getElementById(this.id + '-autocomplete-list');
                if (items) items = items.getElementsByTagName('div');
                if (e.keyCode === 40) { currentFlagFocus++; addActiveFlag(items); }
                else if (e.keyCode === 38) { currentFlagFocus--; addActiveFlag(items); }
                else if (e.keyCode === 13) {
                    e.preventDefault();
                    if (currentFlagFocus > -1 && items) {
                        items[currentFlagFocus].dispatchEvent(new MouseEvent('mousedown'));
                    }
                }
            });

            function addActiveFlag(items) {
                if (!items) return;
                removeActiveFlag(items);
                if (currentFlagFocus >= items.length) currentFlagFocus = 0;
                if (currentFlagFocus < 0) currentFlagFocus = items.length - 1;
                items[currentFlagFocus].classList.add('autocomplete-active');
                items[currentFlagFocus].scrollIntoView({ block: 'nearest' });
            }
            function removeActiveFlag(items) {
                Array.from(items).forEach(i => i.classList.remove('autocomplete-active'));
            }
            function closeFlagLists() {
                document.querySelectorAll('#flagDisplayInput-autocomplete-list')
                    .forEach(el => el.remove());
                currentFlagFocus = -1;
            }
            document.addEventListener('click', closeFlagLists);

            // When a flag is chosen
            function selectFlag(value) {
                athlete.Flag = value;
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                flagInput.value = value;

                if (value !== originalFlag) {
                    restoreFlagBtn.style.display = 'inline-flex';
                } else {
                    restoreFlagBtn.style.display = 'none';
                }
                updateSubmitButtonState();

                closeFlagLists();
            }

            restoreFlagBtn.addEventListener('click', () => {
                revertFlagToOriginal();
            });

            // Restore original flag
            document.getElementById('submitButton').addEventListener('click', function (e) {
                // --- SUBMIT CLICK GUARD ---
                document.getElementById('submitButton').addEventListener('click', function (e) {
                    if (
                        !validateFlagDisplay(flagInput.value) ||
                        !validatePersonalLink(personalLinkInput.value) ||
                        !validateMediaContact(mediaContactInput.value)
                    ) {
                        e.preventDefault();
                    }
                });
            });

            const personalLinkInput = document.getElementById('personalLinkInput');
            const restorePersonalLinkBtn = document.getElementById('restorePersonalLinkBtn');
            personalLinkInput.value = athlete.PersonalLink || '';
            if (athlete.PersonalLink !== originalPersonalLink) {
                restorePersonalLinkBtn.style.display = 'inline-flex';
                updateSubmitButtonState();
            }

            const mediaContactInput = document.getElementById('mediaContactInput');
            const restoreMediaContactBtn = document.getElementById('restoreMediaContactBtn');
            mediaContactInput.value = athlete.MediaContact;
            if (athlete.MediaContact !== originalMediaContact) {
                restoreMediaContactBtn.style.display = 'inline-flex';
                updateSubmitButtonState();
            }
            restoreFlagBtn.addEventListener('click', () => {
                revertFlagToOriginal();
            });
            personalLinkInput.addEventListener('input', () => {
                athlete.PersonalLink = personalLinkInput.value.trim();
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                if (personalLinkInput.value.trim() !== originalPersonalLink) {
                    restorePersonalLinkBtn.style.display = 'inline-flex';
                } else {
                    restorePersonalLinkBtn.style.display = 'none';
                }
                updateSubmitButtonState();
            });
            restorePersonalLinkBtn.addEventListener('click', () => {
                personalLinkInput.value = originalPersonalLink;
                athlete.PersonalLink = originalPersonalLink;
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                restorePersonalLinkBtn.style.display = 'none';
                updateSubmitButtonState();
            });
            mediaContactInput.addEventListener('input', () => {
                athlete.MediaContact = mediaContactInput.value.trim();
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                if (mediaContactInput.value.trim() !== originalMediaContact) {
                    restoreMediaContactBtn.style.display = 'inline-flex';
                } else {
                    restoreMediaContactBtn.style.display = 'none';
                }
                updateSubmitButtonState();
            });
            restoreMediaContactBtn.addEventListener('click', () => {
                mediaContactInput.value = originalMediaContact;
                athlete.MediaContact = originalMediaContact;
                sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
                restoreMediaContactBtn.style.display = 'none';
                updateSubmitButtonState();
            });

            let skipFlagValidation = false;
            restoreFlagBtn.addEventListener('mousedown', () => {
                skipFlagValidation = true;
            });

            flagInput.addEventListener('blur', function () {
                if (skipFlagValidation) {
                    skipFlagValidation = false;
                    return;
                }
                validateFlagDisplay(this.value);
            });

            // --- SKIP-ON-RESTORE FLAGS ---
            let skipPersonalLinkValidation = false;
            restorePersonalLinkBtn.addEventListener('mousedown', () => {
                skipPersonalLinkValidation = true;
            });

            let skipMediaContactValidation = false;
            restoreMediaContactBtn.addEventListener('mousedown', () => {
                skipMediaContactValidation = true;
            });

            // --- BLUR HANDLERS ---
            personalLinkInput.addEventListener('blur', function () {
                if (skipPersonalLinkValidation) {
                    skipPersonalLinkValidation = false;
                    return;
                }
                validatePersonalLink(this.value);
            });

            mediaContactInput.addEventListener('blur', function () {
                if (skipMediaContactValidation) {
                    skipMediaContactValidation = false;
                    return;
                }
                validateMediaContact(this.value);
            });
        });
        function revertFlagToOriginal() {
            const flagInput = document.getElementById('flagDisplayInput');
            const restoreFlagBtn = document.getElementById('restoreFlagBtn');
            flagInput.value = originalFlag;
            athlete.Flag = originalFlag;
            sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
            restoreFlagBtn.style.display = 'none';
            updateSubmitButtonState();
        }

        function setSubmitChangeRequestButton() {
            const submitButton = document.getElementById('submitButton');
            submitButton.innerHTML = 'Submit Change Request&nbsp;<i class="fa fa-rocket"></i>';
            submitButton.setAttribute('type', 'submit');
        }

        const changeProfileBtn = document.getElementById('changeProfilePicButton');
        const changeProfileInput = document.getElementById('profilePicInputModal');
        changeProfileBtn.addEventListener('click', () => {
            changeProfileInput.click();
        });
        changeProfileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (evt) => {
                const cropperModal = document.getElementById('changeProfileCropperModal');
                const cropperImage = document.getElementById('changeProfileCropperImage');
                cropperImage.src = evt.target.result;
                cropperModal.style.display = 'flex';
                document.getElementById('modalOverlay').style.display = 'block';
                document.body.classList.add('no-scroll');

                // expose globally so crop/cancel buttons can access it
                window.changeProfileCropper = new Cropper(cropperImage, {
                    aspectRatio: 1,
                    viewMode: 1,
                    autoCropArea: 1,
                });
            };
            reader.readAsDataURL(file);
        });

        // Crop & Cancel handlers for change-profile
        const cropBtn = document.getElementById('changeProfileCropButton');
        const cancelBtn = document.getElementById('changeProfileCancelButton');
        cropBtn.addEventListener('click', () => {
            const canvas = window.changeProfileCropper.getCroppedCanvas({
                width: 1024,
                height: 1024,
            });
            const newSrc = canvas.toDataURL('image/png');
            const imgEl = document.querySelector('.illustration');
            imgEl.src = newSrc;
            imgEl.alt = athlete.Name + ' headshot';
            athlete.ProfilePic = newSrc;
            sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
            document.getElementById('restoreProfilePicButton').style.display = 'inline-flex';

            // enable the “Submit Change Request” button now that there’s a new image
            updateSubmitButtonState();
            window.changeProfileCropper.destroy();
            document.getElementById('modalOverlay').style.display = 'none';
            document.body.classList.remove('no-scroll');
            document.getElementById('changeProfileCropperModal').style.display = 'none';
            changeProfileInput.value = '';
        });
        cancelBtn.addEventListener('click', () => {
            window.changeProfileCropper.destroy();
            document.getElementById('modalOverlay').style.display = 'none';
            document.body.classList.remove('no-scroll');
            document.getElementById('changeProfileCropperModal').style.display = 'none';
            changeProfileInput.value = '';
        });
        const restoreBtn = document.getElementById('restoreProfilePicButton');
        restoreBtn.addEventListener('click', () => {
            const imgEl = document.querySelector('.illustration');
            imgEl.src = originalProfilePicSrc;
            athlete.ProfilePic = originalProfilePicSrc;
            sessionStorage.setItem('selectedAthlete', JSON.stringify(athlete));
            restoreBtn.style.display = 'none';
            // go back to “nothing changed,” so disable submit again
            updateSubmitButtonState();
        });

        function validateFlagDisplay(value) {
            const flagDisplayError = document.getElementById('flagDisplayError');
            const trimmed = value.trim();
            const regex = /^[A-Za-zÀ-ÖØ-öø-ÿ][A-Za-zÀ-ÖØ-öø-ÿ0-9\s'(),.\-]{2,99}$/;
            if (trimmed.length < 3) {
                customAlert('Flag must be at least 3 characters long.');
                revertFlagToOriginal();

                return false;
            }
            if (!regex.test(trimmed)) {
                customAlert('Flag contains invalid characters.');
                revertFlagToOriginal();

                return false;
            }
            return true;
        }

        const submitButton = document.getElementById('submitButton');

        function updateSubmitButtonState() {
            const submitButton = document.getElementById('submitButton');
            const currentPicSrc = document.querySelector('.illustration').getAttribute('src');
            const currentDivision = document.getElementById('divisionDisplaySelect').value;
            const currentFlag = document.getElementById('flagDisplayInput').value.trim();
            const currentPersonalLink = document.getElementById('personalLinkInput').value.trim();
            const currentMediaContact = document.getElementById('mediaContactInput').value.trim();

            const picChanged = currentPicSrc !== originalProfilePicSrc;
            const divChanged = currentDivision !== originalDivision;
            const flagChanged = currentFlag !== originalFlag;
            const personalLinkChanged = currentPersonalLink !== originalPersonalLink;
            const mediaContactChanged = currentMediaContact !== originalMediaContact;

            const anyChanged = picChanged
                || divChanged
                || flagChanged
                || personalLinkChanged
                || mediaContactChanged;

            submitButton.disabled = !anyChanged;

        }

        function validatePersonalLink(value) {
            // TODO: implement personal link validation
            return true;
        }

        function validateMediaContact(value) {
            // TODO: implement media contact validation
            return true;
        }
    </script>
    <script src="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.js" defer></script>
</body>
</html>